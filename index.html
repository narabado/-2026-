<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="pageTitle">2026 å¥ˆè‰¯ãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³æ–°å¹´å›£ä½“æˆ¦ ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼</title>
  <style>
    /* =================================
       ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ»ãƒ™ãƒ¼ã‚¹
       ================================= */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', 'Yu Gothic', 'Hiragino Sans', sans-serif;
      background: linear-gradient(135deg, #1a0b2e 0%, #16213e 50%, #0f3460 100%), 
                  url('https://www.genspark.ai/api/files/s/VQLHXmYf?cache_control=3600');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      background-blend-mode: overlay;
      min-height: 100vh;
      padding: 20px;
      position: relative;
    }
    
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 20% 50%, rgba(138, 43, 226, 0.15) 0%, transparent 50%),
                  radial-gradient(circle at 80% 80%, rgba(0, 191, 255, 0.15) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }
    
    body::after {
      content: 'ğŸŠâœ¨ğŸ†ğŸŒ¸ğŸ‹ğŸ’«ğŸŠâœ¨ğŸ†ğŸŒ¸ğŸ‹ğŸ’«ğŸŠâœ¨ğŸ†ğŸŒ¸ğŸ‹ğŸ’«';
      position: fixed;
      top: -50px;
      left: 0;
      width: 200%;
      font-size: 2rem;
      opacity: 0.3;
      animation: scroll-emoji 20s linear infinite;
      pointer-events: none;
      z-index: 0;
      letter-spacing: 80px;
    }
    
    @keyframes scroll-emoji {
      from {
        transform: translateX(0);
      }
      to {
        transform: translateX(-50%);
      }
    }
    
    body > * {
      position: relative;
      z-index: 1;
    }

    h1 {
      text-align: center;
      color: #00d4ff;
      margin-bottom: 20px;
      font-size: 1.8rem;
      text-shadow: 0 0 10px rgba(0, 212, 255, 0.8),
                   0 0 20px rgba(0, 212, 255, 0.6),
                   0 0 30px rgba(0, 212, 255, 0.4),
                   2px 2px 4px rgba(0,0,0,0.5);
      font-weight: bold;
      letter-spacing: 1px;
      position: relative;
    }
    
    h1::before {
      content: 'ğŸ';
      position: absolute;
      left: 10%;
      font-size: 1.5rem;
      animation: glow 2s ease-in-out infinite alternate;
    }
    
    h1::after {
      content: 'ğŸ';
      position: absolute;
      right: 10%;
      font-size: 1.5rem;
      animation: glow 2s ease-in-out infinite alternate;
    }
    
    @keyframes glow {
      from {
        filter: drop-shadow(0 0 5px #FFD700) drop-shadow(0 0 10px #FFD700);
      }
      to {
        filter: drop-shadow(0 0 10px #FFD700) drop-shadow(0 0 20px #FFD700) drop-shadow(0 0 30px #FFA500);
      }
    }

    /* =================================
       ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆã‚¹ã‚¿ã‚¤ãƒ«
       ================================= */
    .tabs {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .tab-button {
      padding: 12px 24px;
      background: rgba(0, 212, 255, 0.1);
      border: 2px solid #00d4ff;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: bold;
      color: #00d4ff;
      transition: all 0.3s;
      box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    .tab-button::before {
      content: 'âœ¨';
      position: absolute;
      top: 50%;
      left: -20px;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.3s;
    }
    
    .tab-button:hover::before {
      left: 10px;
      opacity: 1;
    }

    .tab-button:hover {
      background: rgba(0, 212, 255, 0.2);
      box-shadow: 0 0 20px rgba(0, 212, 255, 0.6);
      transform: translateY(-2px);
    }

    .tab-button.active {
      background: linear-gradient(135deg, #00d4ff 0%, #7b2ff7 100%);
      color: #fff;
      box-shadow: 0 0 30px rgba(0, 212, 255, 0.8),
                  0 0 60px rgba(123, 47, 247, 0.6);
    }

    /* =================================
       ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å…±é€š
       ================================= */
    .tab-content {
      display: none;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 212, 255, 0.3),
                  0 0 0 1px rgba(0, 212, 255, 0.2);
      max-width: 900px;
      margin: 0 auto;
    }

    .tab-content.active {
      display: block;
    }

    .section {
      margin-bottom: 30px;
    }

    .section h2 {
      font-size: 1.3rem;
      color: #0f3460;
      border-bottom: 2px solid #00d4ff;
      padding-bottom: 8px;
      margin-bottom: 16px;
      text-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
    }

    /* =================================
       ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ 
       ================================= */
    label {
      display: inline-block;
      font-weight: 600;
      color: #333;
      margin-bottom: 6px;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    select {
      width: 100%;
      padding: 10px;
      font-size: 1rem;
      border: 1px solid #bbb;
      border-radius: 6px;
      background-color: #fafafa;
      transition: border-color 0.2s;
    }

    input:focus, select:focus {
      outline: none;
      border-color: #00d4ff;
      background-color: #fff;
      box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
    }

    .form-row {
      display: flex;
      gap: 12px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .form-col {
      flex: 1;
      min-width: 200px;
    }

    /* =================================
       é¸æ‰‹ã‚«ãƒ¼ãƒ‰
       ================================= */
    .player-card {
      border: 2px solid rgba(0, 212, 255, 0.3);
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 16px;
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.08) 0%, rgba(0, 212, 255, 0.05) 50%, rgba(123, 47, 247, 0.05) 100%);
      box-shadow: 0 0 15px rgba(0, 212, 255, 0.1), 0 0 5px rgba(255, 215, 0, 0.1);
      position: relative;
    }
    
    .player-card::after {
      content: 'ğŸ¸';
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      opacity: 0.15;
    }

    .player-card h3 {
      font-size: 1.1rem;
      color: #0f3460;
      margin-bottom: 12px;
      font-weight: bold;
    }

    /* =================================
       ãƒœã‚¿ãƒ³
       ================================= */
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      margin-top: 16px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #FFD700 0%, #00d4ff 50%, #7b2ff7 100%);
      color: #fff;
      font-size: 1.5rem;
      padding: 20px 60px;
      margin-top: 24px;
      min-width: 300px;
      box-shadow: 0 0 30px rgba(255, 215, 0, 0.4),
                  0 0 40px rgba(0, 212, 255, 0.6),
                  0 10px 50px rgba(123, 47, 247, 0.4);
      border: 2px solid rgba(255, 215, 0, 0.6);
      position: relative;
      overflow: hidden;
    }
    
    .btn-primary::before {
      content: 'ğŸŠ';
      position: absolute;
      left: 20px;
      font-size: 1.2rem;
    }
    
    .btn-primary::after {
      content: 'ğŸŠ';
      position: absolute;
      right: 20px;
      font-size: 1.2rem;
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #00e5ff 0%, #8e3bff 100%);
      transform: scale(1.05);
      box-shadow: 0 0 40px rgba(0, 212, 255, 0.9),
                  0 15px 50px rgba(123, 47, 247, 0.6);
    }

    .btn-primary:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      transform: scale(1);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #00d4ff 0%, #00b8d4 100%);
      color: #fff;
      box-shadow: 0 0 20px rgba(0, 212, 255, 0.4);
      border: 1px solid rgba(0, 212, 255, 0.5);
    }

    .btn-secondary:hover {
      background: linear-gradient(135deg, #00e5ff 0%, #00c9e6 100%);
      box-shadow: 0 0 30px rgba(0, 212, 255, 0.7);
    }

    .btn-danger {
      background-color: #e74c3c;
      color: #fff;
      padding: 8px 16px;
      font-size: 0.9rem;
    }

    .btn-danger:hover {
      background-color: #c0392b;
    }

    .btn-warning {
      background-color: #f39c12;
      color: #fff;
      padding: 8px 16px;
      font-size: 0.9rem;
    }

    .btn-warning:hover {
      background-color: #d68910;
    }

    /* =================================
       ç™»éŒ²çŠ¶æ³ã‚¿ãƒ–
       ================================= */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-bottom: 20px;
    }
    
    @media (max-width: 768px) {
      .stats-container {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .stat-box {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(0, 212, 255, 0.1) 50%, rgba(123, 47, 247, 0.1) 100%);
      border: 2px solid rgba(0, 212, 255, 0.4);
      border-radius: 10px;
      padding: 16px;
      text-align: center;
      box-shadow: 0 0 20px rgba(0, 212, 255, 0.2), 0 0 10px rgba(255, 215, 0, 0.1);
      backdrop-filter: blur(5px);
      position: relative;
      overflow: hidden;
    }
    
    .stat-box::before {
      content: 'âœ¨';
      position: absolute;
      top: 5px;
      right: 5px;
      font-size: 1.2rem;
      opacity: 0.3;
      animation: twinkle 2s ease-in-out infinite;
    }
    
    @keyframes twinkle {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(1.2); }
    }

    .stat-box h3 {
      font-size: 1rem;
      color: #0f3460;
      margin-bottom: 8px;
      font-weight: 600;
    }

    .stat-box p {
      font-size: 2rem;
      font-weight: bold;
      color: #00d4ff;
      text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
    }

    /* =================================
       ç®¡ç†ã‚¿ãƒ–
       ================================= */
    #adminLoginArea {
      text-align: center;
      padding: 40px 20px;
    }

    #adminContent {
      display: none;
    }

    #adminTable {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      overflow-x: auto;
      display: block;
    }

    #adminTable th,
    #adminTable td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: left;
      font-size: 0.9rem;
    }

    #adminTable th {
      background: linear-gradient(135deg, #00d4ff 0%, #7b2ff7 100%);
      color: #fff;
      font-weight: bold;
      position: sticky;
      top: 0;
      text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    }

    #adminTable tr:nth-child(even) {
      background: rgba(0, 212, 255, 0.05);
    }

    #adminTable tr:hover {
      background: rgba(0, 212, 255, 0.1);
      box-shadow: 0 0 10px rgba(0, 212, 255, 0.2);
    }

    .deleted-row {
      background-color: #ffcccc !important;
      opacity: 0.7;
    }

    /* =================================
       ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
       ================================= */
    .message {
      padding: 12px;
      border-radius: 8px;
      margin-top: 16px;
      font-weight: 600;
    }

    .message.success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .message.error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    /* =================================
       ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
       ================================= */
    .loading {
      display: none;
      text-align: center;
      padding: 20px;
      color: #00d4ff;
      font-weight: bold;
      text-shadow: 0 0 10px rgba(0, 212, 255, 0.6);
    }

    .loading.active {
      display: block;
    }

    /* =================================
       ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–èª¿æ•´
       ================================= */
    @media (max-width: 768px) {
      h1 {
        font-size: 1.5rem;
      }

      .tab-button {
        padding: 10px 16px;
        font-size: 0.9rem;
      }

      .tab-content {
        padding: 20px;
      }

      .form-row {
        flex-direction: column;
      }

      .stat-box p {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>

  <h1 id="mainTitle" style="cursor: default;">ğŸ¸ 2026 å¥ˆè‰¯ãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³æ–°å¹´å›£ä½“æˆ¦ ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ ğŸ‰</h1>
  
  <!-- æ–°å¹´é£¾ã‚Šã‚¨ãƒ•ã‚§ã‚¯ãƒˆ -->
  <div style="text-align: center; margin-bottom: 10px; font-size: 0.9rem; color: #FFD700; text-shadow: 0 0 10px rgba(255, 215, 0, 0.8); font-weight: bold;">
    âœ¨ è¬¹è³€æ–°å¹´ ãƒ» Happy New Year 2026 âœ¨
  </div>

  <!-- ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ -->
  <div class="tabs">
    <button class="tab-button active" onclick="switchTab('registration')">ãƒãƒ¼ãƒ ç™»éŒ²</button>
    <button class="tab-button" onclick="switchTab('status')">ç™»éŒ²çŠ¶æ³</button>
    <button class="tab-button" onclick="switchTab('admin')">ç®¡ç†</button>
  </div>

  <!-- ========================================
       ã‚¿ãƒ–1: ãƒãƒ¼ãƒ ç™»éŒ²
       ======================================== -->
  <div id="registration" class="tab-content active">
    <form id="entryForm">
      
      <!-- ç”³è¾¼è€…æƒ…å ± -->
      <div class="section">
        <h2>ç”³è¾¼è€…æƒ…å ±</h2>
        <div class="form-row">
          <div class="form-col">
            <label>æ°å <span style="color:red;">*</span></label>
            <input type="text" id="applicant_name" name="applicant_name" required>
          </div>
          <div class="form-col">
            <label>ãƒ•ãƒªã‚¬ãƒŠ <span style="color:red;">*</span></label>
            <input type="text" id="applicant_kana" name="applicant_kana" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-col">
            <label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span style="color:red;">*</span></label>
            <input type="email" id="applicant_email" name="applicant_email" required>
          </div>
          <div class="form-col">
            <label>é›»è©±ç•ªå· <span style="color:red;">*</span></label>
            <input type="tel" id="applicant_phone" name="applicant_phone" required>
          </div>
        </div>
      </div>

      <!-- ãƒãƒ¼ãƒ æƒ…å ± -->
      <div class="section">
        <h2>ãƒãƒ¼ãƒ æƒ…å ±</h2>
        <div class="form-row">
          <div class="form-col">
            <label>ãƒãƒ¼ãƒ å <span style="color:red;">*</span></label>
            <input type="text" id="team_name" name="team_name" required>
          </div>
          <div class="form-col">
            <label>ãƒãƒ¼ãƒ ãƒ©ãƒ³ã‚¯ <span style="color:red;">*</span></label>
            <select id="team_rank" name="team_rank" required onchange="updateRankOptions()">
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option value="A">Aã‚¯ãƒ©ã‚¹</option>
              <option value="B">Bã‚¯ãƒ©ã‚¹</option>
              <option value="C">Cã‚¯ãƒ©ã‚¹</option>
              <option value="D">Dã‚¯ãƒ©ã‚¹</option>
            </select>
          </div>
        </div>
      </div>

      <!-- å‡ºå ´æ¡ä»¶è¡¨ç¤º -->
      <div class="section" style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.15) 0%, rgba(0, 212, 255, 0.15) 50%, rgba(123, 47, 247, 0.15) 100%); padding:16px; border-radius:8px; border:2px solid rgba(255, 215, 0, 0.5); margin-bottom:20px; box-shadow: 0 0 20px rgba(255, 215, 0, 0.3), 0 0 40px rgba(0, 212, 255, 0.2);">
        <h2 style="color:#0f3460; margin-bottom:12px; text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);">ğŸ ãƒãƒ¼ãƒ ç·¨æˆæ¡ä»¶ ğŸ</h2>
        <ul style="margin-left:20px; line-height:1.8; color:#333;">
          <li><strong>Aã‚¯ãƒ©ã‚¹:</strong> ï¼ˆå¥³å­ + Bãƒ©ãƒ³ã‚¯ç”·å­ï¼‰ã®åˆè¨ˆã‚’2åä»¥ä¸Šå«ã‚€</li>
          <li><strong>Bã‚¯ãƒ©ã‚¹:</strong> ï¼ˆå¥³å­ + Cãƒ©ãƒ³ã‚¯ç”·å­ï¼‰ã®åˆè¨ˆã‚’2åä»¥ä¸Šå«ã‚€</li>
          <li><strong>Cã‚¯ãƒ©ã‚¹:</strong> ï¼ˆå¥³å­Bãƒ©ãƒ³ã‚¯ä»¥ä¸‹ + Dãƒ©ãƒ³ã‚¯ç”·å­ï¼‰ã®åˆè¨ˆã‚’2åä»¥ä¸Šå«ã‚€</li>
          <li><strong>Dã‚¯ãƒ©ã‚¹:</strong> ç”·å¥³ã®åˆ¶é™ãªã—</li>
          <li><strong>é¸æ‰‹æ•°:</strong> 4åä»¥ä¸Š6åä»¥ä¸‹ï¼ˆå¿…é ˆï¼‰</li>
        </ul>
      </div>

      <!-- é¸æ‰‹æƒ…å ± -->
      <div class="section">
        <h2>é¸æ‰‹æƒ…å ±ï¼ˆ4åä»¥ä¸Šå¿…é ˆã€æœ€å¤§6åï¼‰</h2>
        
        <!-- é¸æ‰‹1ã€œ6ã®ã‚«ãƒ¼ãƒ‰ -->
        <div id="playersContainer">
          <!-- JavaScriptã§å‹•çš„ç”Ÿæˆ -->
        </div>
      </div>

      <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
      <div style="text-align: center;">
        <button type="submit" class="btn btn-primary" id="submitBtn">ç™»éŒ²ã™ã‚‹</button>
      </div>
      
      <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º -->
      <div id="formLoading" class="loading">é€ä¿¡ä¸­...</div>
      
      <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
      <div id="formMessage"></div>
    </form>
  </div>

  <!-- ========================================
       ã‚¿ãƒ–2: ç™»éŒ²çŠ¶æ³
       ======================================== -->
  <div id="status" class="tab-content">
    <h2>ç¾åœ¨ã®ç™»éŒ²çŠ¶æ³</h2>
    
    <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º -->
    <div id="statusLoading" class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>
    
    <!-- çµ±è¨ˆè¡¨ç¤º -->
    <div class="stats-container" id="statsContainer">
      <!-- JavaScriptã§å‹•çš„ç”Ÿæˆ -->
    </div>

    <!-- è‡ªå‹•æ›´æ–°ã«å¤‰æ›´ã—ãŸãŸã‚ãƒœã‚¿ãƒ³å‰Šé™¤ -->
  </div>

  <!-- ========================================
       ã‚¿ãƒ–3: ç®¡ç†
       ======================================== -->
  <div id="admin" class="tab-content">
    
    <!-- ãƒ­ã‚°ã‚¤ãƒ³ã‚¨ãƒªã‚¢ -->
    <div id="adminLoginArea">
      <h2>ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³</h2>
      <div style="max-width:400px; margin:20px auto;">
        <label>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
        <input type="password" id="adminPassword" style="width:100%; margin-bottom:12px;">
        <button class="btn btn-secondary" onclick="adminLogin()">ãƒ­ã‚°ã‚¤ãƒ³</button>
      </div>
    </div>

    <!-- ãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div id="adminContent">
      <h2>å…¨ç™»éŒ²ãƒ‡ãƒ¼ã‚¿ï¼ˆå‰Šé™¤æ¸ˆã¿å«ã‚€ï¼‰</h2>
      
      <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º -->
      <div id="adminLoading" class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>
      
      <button class="btn btn-secondary" onclick="adminLoadAll()">ãƒ‡ãƒ¼ã‚¿å†èª­è¾¼</button>
      
      <div style="overflow-x:auto; margin-top:20px;">
        <table id="adminTable">
          <thead>
            <tr>
              <th>ID</th>
              <th>ãƒãƒ¼ãƒ å</th>
              <th>ç”³è¾¼è€…</th>
              <th>ãƒ¡ãƒ¼ãƒ«</th>
              <th>é›»è©±</th>
              <th>ãƒ©ãƒ³ã‚¯</th>
              <th>é¸æ‰‹æ•°</th>
              <th>å‰Šé™¤</th>
              <th>æ“ä½œ</th>
            </tr>
          </thead>
          <tbody id="adminTableBody">
            <!-- JavaScriptã§å‹•çš„ç”Ÿæˆ -->
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ========================================
       JavaScript
       ======================================== -->
  <script>
    // ===========================================
    // å®šæ•°è¨­å®šï¼ˆæ–°ã—ã„GAS URLï¼‰
    // ===========================================
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwwNW892gelpcehk1f82wD28kKeZgN1SQQ_1h2t_EGIl3hvOAqf90jd7J_GACIXkUPz/exec';
    const ADMIN_PASSWORD = 'narabado2026';

    // ===========================================
    // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
    // ===========================================
    function switchTab(tabName) {
      // å…¨ã‚¿ãƒ–éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–
      document.querySelectorAll('.tab-content').forEach(function(tab) {
        tab.classList.remove('active');
      });
      document.querySelectorAll('.tab-button').forEach(function(btn) {
        btn.classList.remove('active');
      });

      // æŒ‡å®šã‚¿ãƒ–ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–
      document.getElementById(tabName).classList.add('active');
      event.target.classList.add('active');

      // ç™»éŒ²çŠ¶æ³ã‚¿ãƒ–ã‚’é–‹ã„ãŸã‚‰å³åº§ã«æ›´æ–°
      if (tabName === 'status') {
        loadEntries();
        startAutoUpdate(); // è‡ªå‹•æ›´æ–°ã‚’å†é–‹
      } else {
        stopAutoUpdate(); // ä»–ã®ã‚¿ãƒ–ã§ã¯è‡ªå‹•æ›´æ–°åœæ­¢
      }
    }

    // ===========================================
    // é¸æ‰‹ã‚«ãƒ¼ãƒ‰å‹•çš„ç”Ÿæˆï¼ˆ6ååˆ†ï¼‰
    // ===========================================
    function initPlayerCards() {
      var container = document.getElementById('playersContainer');
      container.innerHTML = '';

      for (var i = 1; i <= 6; i++) {
        var card = document.createElement('div');
        card.className = 'player-card';
        var isRequired = i <= 4;
        card.innerHTML = 
          '<h3>é¸æ‰‹' + i + (isRequired ? ' <span style="color:red;">*å¿…é ˆ</span>' : '') + '</h3>' +
          '<div class="form-row">' +
            '<div class="form-col">' +
              '<label>æ°å</label>' +
              '<input type="text" id="player' + i + '_name" name="player' + i + '_name" ' + (isRequired ? 'required' : '') + '>' +
            '</div>' +
            '<div class="form-col">' +
              '<label>ãƒ•ãƒªã‚¬ãƒŠ</label>' +
              '<input type="text" id="player' + i + '_kana" name="player' + i + '_kana" ' + (isRequired ? 'required' : '') + '>' +
            '</div>' +
          '</div>' +
          '<div class="form-row">' +
            '<div class="form-col">' +
              '<label>å­¦å¹´</label>' +
              '<select id="player' + i + '_grade" name="player' + i + '_grade" ' + (isRequired ? 'required' : '') + '>' +
                '<option value="">é¸æŠ</option>' +
                '<option value="å°1">å°1</option>' +
                '<option value="å°2">å°2</option>' +
                '<option value="å°3">å°3</option>' +
                '<option value="å°4">å°4</option>' +
                '<option value="å°5">å°5</option>' +
                '<option value="å°6">å°6</option>' +
                '<option value="ä¸­1">ä¸­1</option>' +
                '<option value="ä¸­2">ä¸­2</option>' +
                '<option value="ä¸­3">ä¸­3</option>' +
                '<option value="é«˜1">é«˜1</option>' +
                '<option value="é«˜2">é«˜2</option>' +
                '<option value="é«˜3">é«˜3</option>' +
                '<option value="å¤§å­¦1å¹´">å¤§å­¦1å¹´</option>' +
                '<option value="å¤§å­¦2å¹´">å¤§å­¦2å¹´</option>' +
                '<option value="å¤§å­¦3å¹´">å¤§å­¦3å¹´</option>' +
                '<option value="å¤§å­¦4å¹´">å¤§å­¦4å¹´</option>' +
                '<option value="20ä»£">20ä»£</option>' +
                '<option value="30ä»£">30ä»£</option>' +
                '<option value="40ä»£">40ä»£</option>' +
                '<option value="50ä»£">50ä»£</option>' +
                '<option value="60ä»£">60ä»£</option>' +
              '</select>' +
            '</div>' +
            '<div class="form-col">' +
              '<label>æ€§åˆ¥</label>' +
              '<select id="player' + i + '_gender" name="player' + i + '_gender" ' + (isRequired ? 'required' : '') + ' onchange="updateRankOptions()">' +
                '<option value="">é¸æŠ</option>' +
                '<option value="ç”·æ€§">ç”·æ€§</option>' +
                '<option value="å¥³æ€§">å¥³æ€§</option>' +
              '</select>' +
            '</div>' +
            '<div class="form-col">' +
              '<label>ãƒ©ãƒ³ã‚¯</label>' +
              '<select id="player' + i + '_rank" name="player' + i + '_rank" ' + (isRequired ? 'required' : '') + '>' +
                '<option value="">é¸æŠ</option>' +
              '</select>' +
            '</div>' +
          '</div>';
        container.appendChild(card);
      }
    }

    // ===========================================
    // ãƒ©ãƒ³ã‚¯é¸æŠè‚¢ã®æ›´æ–°ï¼ˆæ—¢å­˜å€¤ä¿æŒï¼‰
    // ===========================================
    function updateRankOptions() {
      var teamRank = document.getElementById('team_rank').value;

      for (var i = 1; i <= 6; i++) {
        var genderSelect = document.getElementById('player' + i + '_gender');
        var rankSelect = document.getElementById('player' + i + '_rank');
        
        if (!genderSelect || !rankSelect) continue;

        var gender = genderSelect.value;
        var currentRank = rankSelect.value; // ç¾åœ¨ã®å€¤ã‚’ä¿å­˜
        
        rankSelect.innerHTML = '<option value="">é¸æŠ</option>';

        if (!gender || !teamRank) continue;

        var ranks = [];
        if (gender === 'ç”·æ€§') {
          if (teamRank === 'A') ranks = ['A', 'B', 'C'];
          else if (teamRank === 'B') ranks = ['B', 'C', 'D'];
          else if (teamRank === 'C') ranks = ['C', 'D'];
          else if (teamRank === 'D') ranks = ['D'];
        } else if (gender === 'å¥³æ€§') {
          if (teamRank === 'A') ranks = ['A', 'B', 'C', 'D'];
          else if (teamRank === 'B') ranks = ['B', 'C', 'D'];
          else if (teamRank === 'C') ranks = ['B', 'C', 'D']; // Cã‚¯ãƒ©ã‚¹ã®å¥³å­ã¯Bä»¥ä¸‹
          else if (teamRank === 'D') ranks = ['D'];
        }

        for (var j = 0; j < ranks.length; j++) {
          var option = document.createElement('option');
          option.value = ranks[j];
          option.textContent = ranks[j];
          rankSelect.appendChild(option);
        }
        
        // ä»¥å‰ã®å€¤ãŒé¸æŠè‚¢ã«å«ã¾ã‚Œã¦ã„ã‚Œã°å¾©å…ƒ
        if (currentRank && ranks.indexOf(currentRank) !== -1) {
          rankSelect.value = currentRank;
        }
      }
    }

    // ===========================================
    // ãƒãƒ¼ãƒ ç·¨æˆæ¡ä»¶ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    // ===========================================
    function validateTeamComposition(data) {
      var teamRank = data.team_rank;
      var femaleCount = 0;
      var maleCount = 0;
      var maleBRankCount = 0;
      var maleCRankCount = 0;
      var maleDRankCount = 0;
      var femaleBOrLowerCount = 0;

      for (var i = 1; i <= 6; i++) {
        var name = data['player' + i + '_name'];
        var gender = data['player' + i + '_gender'];
        var rank = data['player' + i + '_rank'];
        
        if (!name) continue;
        
        if (gender === 'å¥³æ€§') {
          femaleCount++;
          if (rank === 'B' || rank === 'C' || rank === 'D') {
            femaleBOrLowerCount++;
          }
        } else if (gender === 'ç”·æ€§') {
          maleCount++;
          if (rank === 'B') maleBRankCount++;
          if (rank === 'C') maleCRankCount++;
          if (rank === 'D') maleDRankCount++;
        }
      }

      // Aã‚¯ãƒ©ã‚¹: ï¼ˆå¥³å­ + Bãƒ©ãƒ³ã‚¯ç”·å­ï¼‰ã®åˆè¨ˆãŒ2åä»¥ä¸Š
      if (teamRank === 'A') {
        var totalCount = femaleCount + maleBRankCount;
        if (totalCount >= 2) {
          return { valid: true };
        } else {
          var msg = 'âš ï¸ Aã‚¯ãƒ©ã‚¹ã®æ¡ä»¶ä¸è¶³\n';
          msg += 'â–  å¿…è¦: ï¼ˆå¥³å­ + Bãƒ©ãƒ³ã‚¯ç”·å­ï¼‰ã®åˆè¨ˆã‚’2åä»¥ä¸Š\n';
          msg += 'â–  ç¾åœ¨: å¥³å­' + femaleCount + 'å + Bãƒ©ãƒ³ã‚¯ç”·å­' + maleBRankCount + 'å = åˆè¨ˆ' + totalCount + 'å';
          return { valid: false, message: msg };
        }
      }
      
      // Bã‚¯ãƒ©ã‚¹: ï¼ˆå¥³å­ + Cãƒ©ãƒ³ã‚¯ç”·å­ï¼‰ã®åˆè¨ˆãŒ2åä»¥ä¸Š
      if (teamRank === 'B') {
        var totalCount = femaleCount + maleCRankCount;
        if (totalCount >= 2) {
          return { valid: true };
        } else {
          var msg = 'âš ï¸ Bã‚¯ãƒ©ã‚¹ã®æ¡ä»¶ä¸è¶³\n';
          msg += 'â–  å¿…è¦: ï¼ˆå¥³å­ + Cãƒ©ãƒ³ã‚¯ç”·å­ï¼‰ã®åˆè¨ˆã‚’2åä»¥ä¸Š\n';
          msg += 'â–  ç¾åœ¨: å¥³å­' + femaleCount + 'å + Cãƒ©ãƒ³ã‚¯ç”·å­' + maleCRankCount + 'å = åˆè¨ˆ' + totalCount + 'å';
          return { valid: false, message: msg };
        }
      }
      
      // Cã‚¯ãƒ©ã‚¹: ï¼ˆå¥³å­Bãƒ©ãƒ³ã‚¯ä»¥ä¸‹ + Dãƒ©ãƒ³ã‚¯ç”·å­ï¼‰ã®åˆè¨ˆãŒ2åä»¥ä¸Š
      if (teamRank === 'C') {
        var totalCount = femaleBOrLowerCount + maleDRankCount;
        if (totalCount >= 2) {
          return { valid: true };
        } else {
          var msg = 'âš ï¸ Cã‚¯ãƒ©ã‚¹ã®æ¡ä»¶ä¸è¶³\n';
          msg += 'â–  å¿…è¦: ï¼ˆå¥³å­Bãƒ©ãƒ³ã‚¯ä»¥ä¸‹ + Dãƒ©ãƒ³ã‚¯ç”·å­ï¼‰ã®åˆè¨ˆã‚’2åä»¥ä¸Š\n';
          msg += 'â–  ç¾åœ¨: å¥³å­Bä»¥ä¸‹' + femaleBOrLowerCount + 'å + Dãƒ©ãƒ³ã‚¯ç”·å­' + maleDRankCount + 'å = åˆè¨ˆ' + totalCount + 'å';
          return { valid: false, message: msg };
        }
      }
      
      // Dã‚¯ãƒ©ã‚¹: ç”·å¥³ã®åˆ¶é™ãªã—
      if (teamRank === 'D') {
        return { valid: true };
      }

      return { valid: true };
    }

    // ===========================================
    // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
    // ===========================================
    document.getElementById('entryForm').addEventListener('submit', function(e) {
      e.preventDefault();

      var formData = new FormData(this);
      var data = { action: 'add' };

      // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
      for (var pair of formData.entries()) {
        data[pair[0]] = pair[1] || '';
      }

      // é¸æ‰‹æ•°ã‚«ã‚¦ãƒ³ãƒˆ
      var playerCount = 0;
      for (var i = 1; i <= 6; i++) {
        if (data['player' + i + '_name']) playerCount++;
      }

      // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
      if (playerCount < 4) {
        showMessage('formMessage', 'âš ï¸ é¸æ‰‹ã¯4åä»¥ä¸Šç™»éŒ²ã—ã¦ãã ã•ã„ï¼ˆç¾åœ¨: ' + playerCount + 'åï¼‰', 'error');
        return;
      }

      // ãƒãƒ¼ãƒ ç·¨æˆæ¡ä»¶ãƒã‚§ãƒƒã‚¯
      var validationResult = validateTeamComposition(data);
      if (!validationResult.valid) {
        showMessage('formMessage', validationResult.message, 'error');
        return;
      }

      // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
      showLoading('formLoading', true);
      hideMessage('formMessage');
      document.getElementById('submitBtn').disabled = true;

      // GASã¸é€ä¿¡
      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify(data)
      })
      .then(function(response) { return response.json(); })
      .then(function(result) {
        if (result.success) {
          showMessage('formMessage', 'ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸ!(ID: ' + result.id + ')', 'success');
          document.getElementById('entryForm').reset();
          initPlayerCards();
          
          // 2ç§’å¾Œã«ç™»éŒ²çŠ¶æ³ãƒšãƒ¼ã‚¸ã«è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ
          setTimeout(function() {
            switchTab('status');
            // ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
            document.querySelectorAll('.tab-button').forEach(function(btn) {
              btn.classList.remove('active');
            });
            document.querySelectorAll('.tab-button')[1].classList.add('active');
          }, 2000);
        } else {
          showMessage('formMessage', 'ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + (result.error || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'), 'error');
        }
      })
      .catch(function(error) {
        showMessage('formMessage', 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message, 'error');
        console.error('é€ä¿¡ã‚¨ãƒ©ãƒ¼:', error);
      })
      .finally(function() {
        showLoading('formLoading', false);
        document.getElementById('submitBtn').disabled = false;
      });
    });

    // ===========================================
    // ç™»éŒ²çŠ¶æ³ã®èª­è¾¼
    // ===========================================
    function loadEntries() {
      showLoading('statusLoading', true);

      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ action: 'get', limit: 1000, offset: 0 })
      })
      .then(function(response) { return response.json(); })
      .then(function(result) {
        if (!result.items) {
          showStats({ teams: 0, players: 0, male: 0, female: 0, ranks: {} });
          return;
        }

        // çµ±è¨ˆè¨ˆç®—
        var stats = {
          teams: result.items.length,
          players: 0,
          male: 0,
          female: 0,
          ranks: { A: 0, B: 0, C: 0, D: 0 }
        };

        for (var i = 0; i < result.items.length; i++) {
          var item = result.items[i];
          
          // ãƒãƒ¼ãƒ ãƒ©ãƒ³ã‚¯ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
          var teamRank = item['team_rank'];
          if (teamRank && stats.ranks[teamRank] !== undefined) {
            stats.ranks[teamRank]++;
          }
          
          for (var j = 1; j <= 6; j++) {
            var name = item['player' + j + '_name'];
            var gender = item['player' + j + '_gender'];

            if (name) {
              stats.players++;
              if (gender === 'ç”·æ€§') stats.male++;
              if (gender === 'å¥³æ€§') stats.female++;
            }
          }
        }

        showStats(stats);
      })
      .catch(function(error) {
        console.error('ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
        showStats({ teams: 0, players: 0, male: 0, female: 0, ranks: {} });
      })
      .finally(function() {
        showLoading('statusLoading', false);
      });
    }

    // ===========================================
    // çµ±è¨ˆè¡¨ç¤º
    // ===========================================
    function showStats(stats) {
      var container = document.getElementById('statsContainer');
      container.innerHTML = 
        '<div class="stat-box"><h3>ç™»éŒ²ãƒãƒ¼ãƒ æ•°</h3><p>' + stats.teams + '</p></div>' +
        '<div class="stat-box"><h3>ç·é¸æ‰‹æ•°</h3><p>' + stats.players + '</p></div>' +
        '<div class="stat-box"><h3>ç”·æ€§</h3><p>' + stats.male + '</p></div>' +
        '<div class="stat-box"><h3>å¥³æ€§</h3><p>' + stats.female + '</p></div>' +
        '<div class="stat-box"><h3>Aã‚¯ãƒ©ã‚¹</h3><p>' + (stats.ranks.A || 0) + 'ãƒãƒ¼ãƒ </p></div>' +
        '<div class="stat-box"><h3>Bã‚¯ãƒ©ã‚¹</h3><p>' + (stats.ranks.B || 0) + 'ãƒãƒ¼ãƒ </p></div>' +
        '<div class="stat-box"><h3>Cã‚¯ãƒ©ã‚¹</h3><p>' + (stats.ranks.C || 0) + 'ãƒãƒ¼ãƒ </p></div>' +
        '<div class="stat-box"><h3>Dã‚¯ãƒ©ã‚¹</h3><p>' + (stats.ranks.D || 0) + 'ãƒãƒ¼ãƒ </p></div>';
    }

    // ===========================================
    // ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³
    // ===========================================
    function adminLogin() {
      var password = document.getElementById('adminPassword').value;
      if (password === ADMIN_PASSWORD) {
        document.getElementById('adminLoginArea').style.display = 'none';
        document.getElementById('adminContent').style.display = 'block';
        enableTitleEdit(); // ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«ã‚¿ã‚¤ãƒˆãƒ«ç·¨é›†ã‚’æœ‰åŠ¹åŒ–
        adminLoadAll();
      } else {
        alert('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“');
      }
    }

    // ===========================================
    // ç®¡ç†è€…ç”¨ï¼šå…¨ãƒ‡ãƒ¼ã‚¿èª­è¾¼
    // ===========================================
    function adminLoadAll() {
      showLoading('adminLoading', true);

      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ action: 'getAll' })
      })
      .then(function(response) { return response.json(); })
      .then(function(result) {
        if (!result.items) {
          document.getElementById('adminTableBody').innerHTML = '<tr><td colspan="9">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
          return;
        }

        var tbody = document.getElementById('adminTableBody');
        tbody.innerHTML = '';

        for (var i = 0; i < result.items.length; i++) {
          var item = result.items[i];
          var isDeleted = item.delete_flag === '1' || item.delete_flag === 1;
          
          // é¸æ‰‹æ•°ã‚«ã‚¦ãƒ³ãƒˆ
          var playerCount = 0;
          for (var j = 1; j <= 6; j++) {
            if (item['player' + j + '_name']) playerCount++;
          }

          var row = document.createElement('tr');
          if (isDeleted) row.classList.add('deleted-row');

          row.innerHTML = 
            '<td>' + (item.id || '-') + '</td>' +
            '<td>' + (item.team_name || '-') + '</td>' +
            '<td>' + (item.applicant_name || '-') + '</td>' +
            '<td>' + (item.applicant_email || '-') + '</td>' +
            '<td>' + (item.applicant_phone || '-') + '</td>' +
            '<td>' + (item.team_rank || '-') + '</td>' +
            '<td>' + playerCount + '</td>' +
            '<td>' + (isDeleted ? 'å‰Šé™¤æ¸ˆã¿' : 'æœ‰åŠ¹') + '</td>' +
            '<td>' + 
              (!isDeleted ? 
                '<button class="btn-danger" onclick="deleteEntry(\'' + item.id + '\')">å‰Šé™¤</button>' : 
                '<button class="btn-warning" onclick="restoreEntry(\'' + item.id + '\')">å¾©å…ƒ</button> ' +
                '<button class="btn-danger" onclick="permanentDelete(\'' + item.id + '\')">å®Œå…¨å‰Šé™¤</button>'
              ) +
            '</td>';
          tbody.appendChild(row);
        }
      })
      .catch(function(error) {
        console.error('ç®¡ç†ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
        alert('ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
      })
      .finally(function() {
        showLoading('adminLoading', false);
      });
    }

    // ===========================================
    // å‰Šé™¤ãƒ»å¾©å…ƒãƒ»å®Œå…¨å‰Šé™¤
    // ===========================================
    function deleteEntry(id) {
      if (!confirm('ID: ' + id + ' ã‚’å‰Šé™¤ã—ã¾ã™ã‹?(å¾©å…ƒå¯èƒ½)')) return;

      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ action: 'delete', id: id })
      })
      .then(function(response) { return response.json(); })
      .then(function(result) {
        if (result.success) {
          alert('å‰Šé™¤ã—ã¾ã—ãŸ');
          adminLoadAll();
        } else {
          alert('å‰Šé™¤ã«å¤±æ•—: ' + (result.error || 'ä¸æ˜'));
        }
      })
      .catch(function(error) {
        alert('ã‚¨ãƒ©ãƒ¼: ' + error.message);
      });
    }

    function restoreEntry(id) {
      if (!confirm('ID: ' + id + ' ã‚’å¾©å…ƒã—ã¾ã™ã‹?')) return;

      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ action: 'restore', id: id })
      })
      .then(function(response) { return response.json(); })
      .then(function(result) {
        if (result.success) {
          alert('å¾©å…ƒã—ã¾ã—ãŸ');
          adminLoadAll();
        } else {
          alert('å¾©å…ƒã«å¤±æ•—: ' + (result.error || 'ä¸æ˜'));
        }
      })
      .catch(function(error) {
        alert('ã‚¨ãƒ©ãƒ¼: ' + error.message);
      });
    }

    function permanentDelete(id) {
      if (!confirm('ID: ' + id + ' ã‚’å®Œå…¨å‰Šé™¤ã—ã¾ã™ã‹?ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“!')) return;

      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ action: 'permanentDelete', id: id })
      })
      .then(function(response) { return response.json(); })
      .then(function(result) {
        if (result.success) {
          alert('å®Œå…¨å‰Šé™¤ã—ã¾ã—ãŸ');
          adminLoadAll();
        } else {
          alert('å®Œå…¨å‰Šé™¤ã«å¤±æ•—: ' + (result.error || 'ä¸æ˜'));
        }
      })
      .catch(function(error) {
        alert('ã‚¨ãƒ©ãƒ¼: ' + error.message);
      });
    }

    // ===========================================
    // ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
    // ===========================================
    function showMessage(elementId, message, type) {
      var msgDiv = document.getElementById(elementId);
      msgDiv.className = 'message ' + type;
      msgDiv.textContent = message;
      msgDiv.style.display = 'block';

      setTimeout(function() {
        msgDiv.style.display = 'none';
      }, 5000);
    }

    function hideMessage(elementId) {
      var msgDiv = document.getElementById(elementId);
      msgDiv.style.display = 'none';
    }

    function showLoading(elementId, show) {
      var loadingDiv = document.getElementById(elementId);
      if (show) {
        loadingDiv.classList.add('active');
      } else {
        loadingDiv.classList.remove('active');
      }
    }

    // ===========================================
    // ã‚¿ã‚¤ãƒˆãƒ«å¤‰æ›´æ©Ÿèƒ½ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
    // ===========================================
    function enableTitleEdit() {
      var mainTitle = document.getElementById('mainTitle');
      var pageTitle = document.getElementById('pageTitle');
      
      mainTitle.contentEditable = 'true';
      mainTitle.style.cursor = 'text';
      mainTitle.style.border = '2px dashed #66bb6a';
      mainTitle.style.padding = '8px';
      
      mainTitle.addEventListener('blur', function() {
        var newTitle = this.textContent.trim();
        if (newTitle) {
          pageTitle.textContent = newTitle;
          localStorage.setItem('customTitle', newTitle);
        }
      });
      
      mainTitle.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          this.blur();
        }
      });
    }
    
    function setupTitleEdit() {
      // ä¿å­˜ã•ã‚ŒãŸã‚¿ã‚¤ãƒˆãƒ«ã‚’èª­ã¿è¾¼ã¿
      var mainTitle = document.getElementById('mainTitle');
      var pageTitle = document.getElementById('pageTitle');
      var savedTitle = localStorage.getItem('customTitle');
      if (savedTitle) {
        mainTitle.textContent = savedTitle;
        pageTitle.textContent = savedTitle;
      }
    }

    // ===========================================
    // è‡ªå‹•æ›´æ–°ã®è¨­å®š
    // ===========================================
    var autoUpdateInterval = null;
    
    function startAutoUpdate() {
      // æ—¢å­˜ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã‚’ã‚¯ãƒªã‚¢
      if (autoUpdateInterval) {
        clearInterval(autoUpdateInterval);
      }
      
      // 30ç§’ã”ã¨ã«è‡ªå‹•æ›´æ–°
      autoUpdateInterval = setInterval(function() {
        // ç™»éŒ²çŠ¶æ³ã‚¿ãƒ–ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå ´åˆã®ã¿æ›´æ–°
        if (document.getElementById('status').classList.contains('active')) {
          loadEntries();
        }
      }, 30000); // 30ç§’ = 30000ãƒŸãƒªç§’
    }
    
    function stopAutoUpdate() {
      if (autoUpdateInterval) {
        clearInterval(autoUpdateInterval);
        autoUpdateInterval = null;
      }
    }

    // ===========================================
    // åˆæœŸåŒ–
    // ===========================================
    window.addEventListener('DOMContentLoaded', function() {
      initPlayerCards();
      updateRankOptions();
      setupTitleEdit();
      startAutoUpdate(); // è‡ªå‹•æ›´æ–°ã‚’é–‹å§‹
    });
  </script>

</body>
</html>